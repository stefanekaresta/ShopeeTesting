angular.module("altairApp").controller("tablesorterCtrl",["$scope","$rootScope","$timeout","$compile","variables","ts_data","ActionProcessFDO","ReconstructMenu","$log",function($scope,$rootScope,$timeout,$compile,variables,ts_data,ActionProcessFDO,ReconstructMenu,$log){function RefreshData(){$scope.selectedData={},$scope.show.main=!0,$scope.show.detail=!1,$scope.show.edit=!1}ReconstructMenu.Init(),$scope.dataListOutputAll=[],$scope.selectedData={},$scope.show={main:!0,detail:!1,edit:!1};var success_get_data=function(data){$scope.dataList=data},error_get_data=function(data){$log.error("data : "+data,data)};ActionProcessFDO.GetListData().then(success_get_data,error_get_data),$scope.editDetail=function(data){$scope.show.main=!1,$scope.show.detail=!1,$scope.show.edit=!0,$scope.selectedData=data},$scope.saveData=function(){var success_edit=function(data){ActionProcessFDO.GetListData().then(success_get_data,error_get_data),UIkit.modal.alert("Update Success!"),RefreshData()},error_edit=function(data){$log.error("Error When update, message : "+JSON.stringify(data)),UIkit.modal.alert("Update Error!")};ActionProcessFDO.UpdateData($scope.selectedData).then(success_edit,error_edit)},$scope.showDetail=function(data){$scope.selectedData=data,$scope.show.main=!1,$scope.show.detail=!0,$scope.show.edit=!1},$scope.back=function(){RefreshData()},$scope.$on("onLastRepeat",function(scope,element,attrs){function createPageSelectize(){selectizeObj=$("select.ts_gotoPage").val($("select.ts_gotoPage option:selected").val()).after('<div class="selectize_fix"></div>').selectize({hideSelected:!0,onDropdownOpen:function($dropdown){$dropdown.hide().velocity("slideDown",{duration:200,easing:variables.easing_swiftOut})},onDropdownClose:function($dropdown){$dropdown.show().velocity("slideUp",{duration:200,easing:variables.easing_swiftOut}),$(".uk-tooltip").hide()}})}var $ts_pager_filter=$("#ts_pager_filter"),$ts_align=$("#ts_align"),$ts_customFilters=$("#ts_custom_filters"),$columnSelector=$("#columnSelector");if($(element).closest($ts_pager_filter).length){var pagerOptions={container:$(".ts_pager"),output:"{startRow} - {endRow} / {filteredRows} ({totalRows})",fixedHeight:!0,removeRows:!1,cssGoto:".ts_gotoPage"};$.tablesorter.language.button_print="Print table",$.tablesorter.language.button_close="Cancel",$("#printTable").on("click",function(e){e.preventDefault(),$ts_pager_filter.trigger("printTable")});var ts_users=$ts_pager_filter.tablesorter({theme:"altair",widthFixed:!0,widgets:["zebra","filter","print","columnSelector"],headers:{0:{sorter:!1,parser:!1}},widgetOptions:{columnSelector_container:$columnSelector,columnSelector_name:"data-name",columnSelector_layout:'<li class="padding_md"><input type="checkbox"><label class="inline-label">{name}</label></li>',columnSelector_saveColumns:!1,print_title:"",print_dataAttrib:"data-name",print_rows:"f",print_columns:"s",print_extraCSS:"",print_styleSheet:"",print_now:!0,print_callback:function(config,$table,printStyle){$rootScope.primarySidebarActive=!1,$rootScope.primarySidebarOpen=!1,$timeout(function(){$.tablesorter.printTable.printOutput(config,$table.html(),printStyle)},300)}}}).tablesorterPager(pagerOptions).on("pagerComplete",function(e,filter){"undefined"!=typeof selectizeObj&&selectizeObj.data("selectize")&&(selectizePage=selectizeObj[0].selectize,selectizePage.setValue($("select.ts_gotoPage option:selected").index()+1,!1))});$columnSelector.children("li").each(function(index){var $this=$(this),id=0==index?"auto":index;$this.children("input").attr("id","column_"+id),$this.children("label").attr("for","column_"+id),$this.children("input").prop("checked",!0).iCheck({checkboxClass:"icheckbox_md",radioClass:"iradio_md",increaseArea:"20%"}),0!=index&&$this.find("input").on("ifChanged",function(ev){$(ev.target).toggleClass("checked").change()})}),$("#column_auto").on("ifChecked",function(ev){$(this).closest("li").siblings("li").find("input").iCheck("disable"),$(ev.target).removeClass("checked").change()}).on("ifUnchecked",function(ev){$(this).closest("li").siblings("li").find("input").iCheck("enable"),$(ev.target).addClass("checked").change()}),createPageSelectize(),$(".pagesize.ts_selectize").after('<div class="selectize_fix"></div>').selectize({hideSelected:!0,onDropdownOpen:function($dropdown){$dropdown.hide().velocity("slideDown",{duration:200,easing:variables.easing_swiftOut})},onDropdownClose:function($dropdown){$dropdown.show().velocity("slideUp",{duration:200,easing:variables.easing_swiftOut}),$(".uk-tooltip").hide(),"undefined"!=typeof selectizeObj&&selectizeObj.data("selectize")&&(selectizePage=selectizeObj[0].selectize,selectizePage.destroy(),$(".ts_gotoPage").next(".selectize_fix").remove(),setTimeout(function(){createPageSelectize()}))}}),$(".ts_checkbox_all").iCheck({checkboxClass:"icheckbox_md",radioClass:"iradio_md",increaseArea:"20%"}).on("ifChecked",function(){$ts_pager_filter.find(".ts_checkbox").prop("checked",!0).iCheck("update").closest("tr").addClass("row_highlighted")}).on("ifUnchecked",function(){$ts_pager_filter.find(".ts_checkbox").prop("checked",!1).iCheck("update").closest("tr").removeClass("row_highlighted")}),$ts_pager_filter.find(".ts_checkbox").on("ifUnchecked",function(){$(this).closest("tr").removeClass("row_highlighted"),$(".ts_checkbox_all").prop("checked",!1).iCheck("update")}).on("ifChecked",function(){$(this).closest("tr").addClass("row_highlighted")}),$ts_pager_filter.on("click",".ts_remove_row",function(e){e.preventDefault();var $this=$(this);UIkit.modal.confirm("Are you sure you want to delete this user?",function(){$this.closest("tr").remove(),ts_users.trigger("update")},{labels:{Ok:"Delete"}})})}if($(element).closest($ts_align).length&&$ts_align.tablesorter({theme:"altair",widgets:["zebra","alignChar"],widgetOptions:{alignChar_wrap:"<i/>",alignChar_charAttrib:"data-align-char",alignChar_indexAttrib:"data-align-index",alignChar_adjustAttrib:"data-align-adjust"}}),$(element).closest($ts_customFilters).length){$ts_customFilters.tablesorter({theme:"altair",headerTemplate:"{content} {icon}",widgets:["zebra","filter"],widgetOptions:{filter_reset:"button.ts_cf_reset",filter_cssFilter:["","ts_cf_range","ts_cf_select_single","ts_cf_datepicker"]}}).on("apply.daterangepicker",function(){$table.trigger("search")});var slider=$(".ts_cf_range").ionRangeSlider({min:"0",max:"1000",type:"double","grid-num":"10","from-min":"10","from-max":"30",input_values_separator:" - "}).data("ionRangeSlider"),$selectize=$(".ts_cf_select_single").after('<div class="selectize_fix"></div>').selectize({hideSelected:!0,dropdownParent:"body",closeAfterSelect:!0,onDropdownOpen:function($dropdown){$dropdown.hide().velocity("slideDown",{duration:200,easing:[.4,0,.2,1]})},onDropdownClose:function($dropdown){$dropdown.show().velocity("slideUp",{duration:200,easing:[.4,0,.2,1]})}}),cf_selectize=$selectize[0].selectize,modal=UIkit.modal("#modal_daterange",{center:!0});$(".ts_cf_datepicker").on("focus",function(){modal.isActive()?modal.hide():modal.show()});var $dp_start=$("#ts_dp_start"),$dp_end=$("#ts_dp_end"),start_date=UIkit.datepicker($dp_start,{format:"MMM D, YYYY"}),end_date=UIkit.datepicker($dp_end,{format:"MMM D, YYYY"});$dp_start.on("change",function(){end_date.options.minDate=$dp_start.val()}),$dp_end.on("change",function(){start_date.options.maxDate=$dp_end.val()}),$("#daterangeApply").on("click",function(e){e.preventDefault(),modal.hide(),$(".ts_cf_datepicker").val($dp_start.val()+" - "+$dp_end.val()).change().blur()}),$("button.ts_cf_reset").on("click",function(){cf_selectize.clear(),slider.reset()})}})}]).factory("ActionProcessFDO",function($timeout,$log,$http,ServerConfig,$q){var service={},agent_process={method:"GET",url:ServerConfig.production+"/neta/wifiid/search/file_detail_output_all",headers:{}};service.GetListData=function(){var deffered=$q.defer();return $http(agent_process).success(function(data,status,headers){deffered.resolve(data)}).error(function(data,status){$log.error(status)}),deffered.promise};var update_data={method:"POST",url:ServerConfig.production+"/neta/wifiid/update/file_detail_output",data:{},headers:{}};return service.UpdateData=function(data){var deffered=$q.defer();return update_data.data=data,$http(update_data).success(function(data,status,headers){deffered.resolve(data)}).error(function(data,status){$log.error(status)}),deffered.promise},service});