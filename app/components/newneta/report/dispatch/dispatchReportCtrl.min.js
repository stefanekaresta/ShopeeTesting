angular.module("altairApp").controller("dispatchReportingCtrl",["$compile","$scope","$timeout","$resource","DTOptionsBuilder","DTColumnBuilder","DTColumnDefBuilder","$log","ngTableParams","$filter","DispatchReportingFactory","ReconstructMenu",function($compile,$scope,$timeout,$resource,DTOptionsBuilder,DTColumnBuilder,DTColumnDefBuilder,$log,ngTableParams,$filter,DispatchReportingFactory,ReconstructMenu){function serverData(sSource,aoData,fnCallback,oSettings){var draw=aoData[0].value,columns=aoData[1].value,start=(aoData[2].value,aoData[3].value),length=aoData[4].value,page=start/length,f_filenameInput=$filter("filter")(columns,{data:"filenameInput"})[0].search.value,tmp={size:10,page:page,filenameInput:f_filenameInput};DispatchReportingFactory.DispatchReportCustom(tmp).then(function(data){$scope.dataResult=data.data,data.draw=draw,data.recordsFiltered=data.recordsTotal,fnCallback(data)},function(data){})}ReconstructMenu.Init();var dispatchreport=this;$scope.notification={select:!0,mainTable:!1,errorMsg:!1,viewDetail:!1},dispatchreport.dtColumns=[DTColumnBuilder.newColumn("filenameInput","File Name Input").withOption("searchable",!0),DTColumnBuilder.newColumn("stepName","Step Name").withOption("searchable",!0),DTColumnBuilder.newColumn("fileSize","File Size").withOption("searchable",!0)],dispatchreport.dtInstance={},$scope.dataResult=[],dispatchreport.dtColumnDefs=[DTColumnDefBuilder.newColumnDef(0).withTitle("filenameInput"),DTColumnDefBuilder.newColumnDef(1).withTitle("stepName"),DTColumnDefBuilder.newColumnDef(3).withTitle("fileSize")],dispatchreport.dtOptions=DTOptionsBuilder.newOptions().withFnServerData(serverData).withDataProp("data").withOption("processing",!0).withOption("serverSide",!0).withOption("paging",!0).withPaginationType("numbers").withDisplayLength(10).withColumnFilter({aoColumns:[{type:"text",bRegex:!0,bSmart:!0}]}).withDOM('<"top">t<i"bottom"p><"clear">'),$scope.generateReport=function(){var blob=new Blob([document.getElementById("exportable").innerHTML],{type:"application/vnd.ms-excel;charset=charset=utf-8"});saveAs(blob,"Dispatch Report.xls")};$scope.listDataRep=["Filename","Step Name","Status"]}]).factory("DispatchReportingFactory",function($http,$q,$log,ServerConfig){var service={},dispatch_report_custom={method:"POST",url:ServerConfig.production+"/neta/wifiid/search/dispatch_report_custom",headers:{},params:{}};return service.DispatchReportCustom=function(data){var deffered=$q.defer();return dispatch_report_custom.data=data,$http(dispatch_report_custom).success(function(data,status,headers){deffered.resolve(data)}).error(function(data,status){$log.error(status)}),deffered.promise},service});