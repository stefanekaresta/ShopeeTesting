<<<<<<< Updated upstream
var altairApp=angular.module("altairApp",["ui.router","oc.lazyLoad","ngSanitize","ngRetina","ncy-angular-breadcrumb","ConsoleLogger","ngTable","angular-md5","ngMap","ngFileUpload","ngCookies","naif.base64","fxpicklist","ivh.treeview"]);altairApp.constant("variables",{header_main_height:48,easing_swiftOut:[.4,0,.2,1],bez_easing_swiftOut:$.bez([.4,0,.2,1])}),altairApp.constant("ServerConfig",{development:"http://localhost:11111",production:"http://localhost:",port_default:30120,port_agitmodule:30120,port_agitmodule_access:30120,port_agitmodule_configuration:30120,port_agitmodule_location:30120,port_agitmodule_organisation:30120,port_agitmodule_security:30120,port_agitmodule_attendance:30120,port_agitmodule_assignment:30120,port_agitmodule_news_event:30120,port_agitmodule_dashboard_report:30120,port_agitmodule_uk:30120,port_agitmodule_patroli:30120,port_agitmodule_master_data:30120,port_agitmodule_user_management:30120}),altairApp.constant("ServerProcess",{development:"http://localhost:30120",production:"http://localhost:30120"}),altairApp.constant("USER_INFO",{userId:"",username:"",password:"",ipAddress:"",macAddress:"",name:"",token:"",series:"",companyId:"",companyName:"",customerId:"",customerName:"",worklocationId:"",worklocationName:""}),altairApp.config(function(ivhTreeviewOptionsProvider){ivhTreeviewOptionsProvider.set({idAttribute:"id",labelAttribute:"label",childrenAttribute:"children",selectedAttribute:"selected",useCheckboxes:!0,disableCheckboxSelectionPropagation:!0,expandToDepth:2,indeterminateAttribute:"__ivhTreeviewIndeterminate",expandedAttribute:"__ivhTreeviewExpanded",defaultSelectedState:!0,validate:!1,twistieExpandedTpl:"(-)",twistieCollapsedTpl:"(+)",twistieLeafTpl:"o"})}),altairApp.config(function($sceDelegateProvider){$sceDelegateProvider.resourceUrlWhitelist(["self","https://www.youtube.com/**","https://w.soundcloud.com/**"])}),altairApp.config(function($breadcrumbProvider){$breadcrumbProvider.setOptions({prefixStateName:"restricted.dashboard",templateUrl:"app/templates/breadcrumbs.tpl.html"})}),altairApp.config(["$httpProvider",function($httpProvider){$httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"]}]),altairApp.factory("SecurityModuleFactory",function($http,$q,$log,ServerConfig,USER_INFO,$cookies,SessionConstruct){var service={},login_request={method:"POST",url:ServerConfig.production+ServerConfig.port_agitmodule_security+"/security/login",data:USER_INFO,headers:{"TOKEN-ID":"000","SERIES-ID":"000","OWNER-COMPANY-ID":"000"}};service.login=function(username,password){var deffered=$q.defer();return $log.info("LOGIN FACTORY"),USER_INFO.username=username,USER_INFO.password=password,$http(login_request).success(function(data,status,headers){localStorage.setItem("data_user_employee",JSON.stringify(data)),deffered.resolve(data),$cookies.put("username",data.employeeTemplate.username),$cookies.put("userid",data.employeeTemplate.employeeId),$cookies.put("name",data.employeeTemplate.employeeName),$cookies.put("npk",data.employeeTemplate.npk);var today=new Date;new Date(today.getTime()+288e5)}).error(function(data,status){$log.error(status)}),deffered.promise};var menu_request={method:"GET",url:ServerConfig.production+ServerConfig.port_agitmodule_security+"/security/get/menu/",headers:{USERNAME:""},params:{}};return service.getMenu=function(username){var deffered=$q.defer();$cookies.put("username",username);$cookies.get("username");return menu_request.headers.USERNAME=username,$http(menu_request).success(function(data,status,headers){deffered.resolve(data)}).error(function(data,status){$log.error(status)}),deffered.promise},service}),altairApp.factory("CommonService",function(){var headInfo=[];return{SetData:function(key,data){headInfo[key]=data},GetData:function(key){return headInfo[key]}}}),altairApp.factory("ReconstructMenu",function(CommonService,$rootScope,$timeout,$log,$location,$state,$cookies,SessionConstruct){return{Init:function(){$timeout(function(){try{var menu=(CommonService.GetData("menuSideBar"),localStorage.getItem("menuSideBar")),objMenu=JSON.parse(menu);null!=objMenu&&void 0!=objMenu?(SessionConstruct.init(),$rootScope.$broadcast("menuSideBar",objMenu)):SessionConstruct.destroy()}catch(err){$log.error(err)}},500)}}}),altairApp.factory("SessionConstruct",function(CommonService,$rootScope,$timeout,$log,$location,$state,$cookies,$window){return{init:function(){$timeout(function(){try{var now=new Date;now.setMinutes(now.getMinutes()+15),$cookies.put("session_iserve",now)}catch(err){$log.error(err)}},500)},destroy:function(){var cookies=$cookies.getAll();angular.forEach(cookies,function(v,k){$cookies.remove(k)}),localStorage.clear(),$location.path("/login"),$state.go("login"),$timeout(function(){$window.location.reload()},500)}}}),altairApp.filter("unique",function(){return function(collection,primaryKey){var output=[],keys=[],splitKeys=primaryKey.split(".");return angular.forEach(collection,function(item){var key={};angular.copy(item,key);for(var i=0;i<splitKeys.length;i++)key=key[splitKeys[i]];keys.indexOf(key)===-1&&(keys.push(key),output.push(item))}),output}}),altairApp.filter("customCurrency",function(){return function(input,symbol,place){if(isNaN(input))return input;var symbol=symbol||"EUROS",place=void 0===place||place;return place===!0?symbol+input:input+symbol}}),altairApp.run(["$rootScope","$state","$stateParams","$http","$window","$timeout","variables","$log","$cookies","$location","CommonService","SecurityModuleFactory","ReconstructMenu",function($rootScope,$state,$stateParams,$http,$window,$timeout,variables,$log,$cookies,$location,CommonService,SecurityModuleFactory,ReconstructMenu){$rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.$on("$stateChangeSuccess",function(){$("html, body").animate({scrollTop:0},200),$timeout(function(){$rootScope.pageLoading=!1},300),$timeout(function(){$rootScope.pageLoaded=!0,$rootScope.appInitialized=!0,$window.Waves.attach(".md-btn-wave,.md-fab-wave",["waves-button"]),$window.Waves.attach(".md-btn-wave-light,.md-fab-wave-light",["waves-button","waves-light"]),"undefined"!=typeof window.isLteIE9&&$("svg,canvas,video").each(function(){var $this=$(this),height=$(this).attr("height");height&&$this.css("height",height),$this.hasClass("peity")&&$this.prev("span").peity()})},600)}),$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){var location=$location.url();if("/login"==location);else{var isAuthenticated=$cookies.get("isAuthenticated");if(console.log("isAuthenticated+"+$cookies.get("isAuthenticated")),1==isAuthenticated)console.log("authenticatred is 1"),$cookies.put("isAuthenticated",2),$location.path("/dashboard1");else if(0==isAuthenticated)$location.path("/login");else if(2==isAuthenticated){console.log("isAuth is 2");var menu_scope=""+$rootScope.sections;if("undefined"==menu_scope){var success_login=function(data){$timeout(function(){$rootScope.$broadcast("menuSideBar",data),CommonService.SetData("menuSideBar",data),console.log("smentara diredirect ke dashboard 1 dulu")},1)},error_login=function(data){console.log("request menu failed")},user_info=$cookies.get("username");$log.info("user_info: "+user_info),console.log("username"),void 0!=user_info&&""!=user_info?SecurityModuleFactory.getMenu(user_info).then(success_login,error_login):$location.path("/login")}}}$rootScope.mainSearchActive=!1,$rootScope.sidebar_secondary=!1,$rootScope.secondarySidebarHiddenLarge=!1,$($window).width()<1220&&($rootScope.primarySidebarActive=!1,$rootScope.hide_content_sidebar=!1),toParams.hasOwnProperty("hidePreloader")||($rootScope.pageLoading=!0,$rootScope.pageLoaded=!1)}),FastClick.attach(document.body),$http.get("./package.json").success(function(response){$rootScope.appVer=response.version}),$rootScope.Modernizr=Modernizr;var w=angular.element($window);$rootScope.largeScreen=w.width()>=1220,w.on("resize",function(){return $rootScope.largeScreen=w.width()>=1220}),$rootScope.primarySidebarOpen=!!$rootScope.largeScreen,$rootScope.pageLoading=!0,$window.Waves.init()}]).run(["PrintToConsole",function(PrintToConsole){PrintToConsole.active=!1}]);
=======
var altairApp=angular.module("altairApp",["ui.router","oc.lazyLoad","ngSanitize","ngRetina","ncy-angular-breadcrumb","ConsoleLogger","ngTable","angular-md5","ngMap","ngFileUpload","ngCookies","naif.base64","fxpicklist","ivh.treeview"]);altairApp.constant("variables",{header_main_height:48,easing_swiftOut:[.4,0,.2,1],bez_easing_swiftOut:$.bez([.4,0,.2,1])}),altairApp.constant("ServerConfig",{development:"http://localhost:11111",production:"http://localhost:",port_default:30120,port_agitmodule:30120,port_agitmodule_access:30120,port_agitmodule_configuration:30120,port_agitmodule_location:30120,port_agitmodule_organisation:30120,port_agitmodule_security:30120,port_agitmodule_attendance:30120,port_agitmodule_assignment:30120,port_agitmodule_news_event:30120,port_agitmodule_dashboard_report:30120,port_agitmodule_uk:30120,port_agitmodule_patroli:30120,port_agitmodule_master_data:30120,port_agitmodule_user_management:30120}),altairApp.constant("ServerProcess",{development:"http://localhost:30120",production:"http://localhost:30120"}),altairApp.constant("USER_INFO",{userId:"",username:"",password:"",ipAddress:"",macAddress:"",name:"",token:"",series:"",companyId:"",companyName:"",customerId:"",customerName:"",worklocationId:"",worklocationName:""}),altairApp.config(function(ivhTreeviewOptionsProvider){ivhTreeviewOptionsProvider.set({idAttribute:"id",labelAttribute:"label",childrenAttribute:"children",selectedAttribute:"selected",useCheckboxes:!0,disableCheckboxSelectionPropagation:!0,expandToDepth:2,indeterminateAttribute:"__ivhTreeviewIndeterminate",expandedAttribute:"__ivhTreeviewExpanded",defaultSelectedState:!0,validate:!1,twistieExpandedTpl:"(-)",twistieCollapsedTpl:"(+)",twistieLeafTpl:"o"})}),altairApp.config(function($sceDelegateProvider){$sceDelegateProvider.resourceUrlWhitelist(["self","https://www.youtube.com/**","https://w.soundcloud.com/**"])}),altairApp.config(function($breadcrumbProvider){$breadcrumbProvider.setOptions({prefixStateName:"restricted.dashboard",templateUrl:"app/templates/breadcrumbs.tpl.html"})}),altairApp.config(["$httpProvider",function($httpProvider){$httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"]}]),altairApp.factory("SecurityModuleFactory",function($http,$q,$log,ServerConfig,USER_INFO,$cookies,SessionConstruct){var service={},login_request={method:"POST",url:ServerConfig.production+ServerConfig.port_agitmodule_security+"/security/login",data:USER_INFO,headers:{"TOKEN-ID":"000","SERIES-ID":"000","OWNER-COMPANY-ID":"000"}};service.login=function(username,password){var deffered=$q.defer();return $log.info("LOGIN FACTORY"),USER_INFO.username=username,USER_INFO.password=password,$http(login_request).success(function(data,status,headers){localStorage.setItem("data_user_employee",JSON.stringify(data)),deffered.resolve(data),$cookies.put("username",data.employeeTemplate.username),$cookies.put("userid",data.employeeTemplate.employeeId),$cookies.put("name",data.employeeTemplate.employeeName),$cookies.put("npk",data.employeeTemplate.npk);var today=new Date;new Date(today.getTime()+288e5)}).error(function(data,status){$log.error(status)}),deffered.promise};var menu_request={method:"GET",url:ServerConfig.production+ServerConfig.port_agitmodule_security+"/security/get/menu/",headers:{USERNAME:""},params:{}};return service.getMenu=function(username){var deffered=$q.defer();$cookies.put("username",username);$cookies.get("username");return menu_request.headers.USERNAME=username,$http(menu_request).success(function(data,status,headers){deffered.resolve(data)}).error(function(data,status){$log.error(status)}),deffered.promise},service}),altairApp.factory("CommonService",function(){var headInfo=[];return{SetData:function(key,data){headInfo[key]=data},GetData:function(key){return headInfo[key]}}}),altairApp.factory("ReconstructMenu",function(CommonService,$rootScope,$timeout,$log,$location,$state,$cookies,SessionConstruct){return{Init:function(){$timeout(function(){try{var menu=(CommonService.GetData("menuSideBar"),localStorage.getItem("menuSideBar")),objMenu=JSON.parse(menu);null!=objMenu&&void 0!=objMenu?(SessionConstruct.init(),$rootScope.$broadcast("menuSideBar",objMenu)):SessionConstruct.destroy()}catch(err){$log.error(err)}},500)}}}),altairApp.factory("SessionConstruct",function(CommonService,$rootScope,$timeout,$log,$location,$state,$cookies,$window){return{init:function(){$timeout(function(){try{var now=new Date;now.setMinutes(now.getMinutes()+15),$cookies.put("session_iserve",now)}catch(err){$log.error(err)}},500)},destroy:function(){var cookies=$cookies.getAll();angular.forEach(cookies,function(v,k){$cookies.remove(k)}),localStorage.clear(),$location.path("/login"),$state.go("login"),$timeout(function(){$window.location.reload()},500)}}}),altairApp.filter("unique",function(){return function(collection,primaryKey){var output=[],keys=[],splitKeys=primaryKey.split(".");return angular.forEach(collection,function(item){var key={};angular.copy(item,key);for(var i=0;i<splitKeys.length;i++)key=key[splitKeys[i]];keys.indexOf(key)===-1&&(keys.push(key),output.push(item))}),output}}),altairApp.run(["$rootScope","$state","$stateParams","$http","$window","$timeout","variables","$log","$cookies","$location","CommonService","SecurityModuleFactory","ReconstructMenu",function($rootScope,$state,$stateParams,$http,$window,$timeout,variables,$log,$cookies,$location,CommonService,SecurityModuleFactory,ReconstructMenu){$rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.$on("$stateChangeSuccess",function(){$("html, body").animate({scrollTop:0},200),$timeout(function(){$rootScope.pageLoading=!1},300),$timeout(function(){$rootScope.pageLoaded=!0,$rootScope.appInitialized=!0,$window.Waves.attach(".md-btn-wave,.md-fab-wave",["waves-button"]),$window.Waves.attach(".md-btn-wave-light,.md-fab-wave-light",["waves-button","waves-light"]),"undefined"!=typeof window.isLteIE9&&$("svg,canvas,video").each(function(){var $this=$(this),height=$(this).attr("height");height&&$this.css("height",height),$this.hasClass("peity")&&$this.prev("span").peity()})},600)}),$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){var location=$location.url();if("/login"==location);else{var isAuthenticated=$cookies.get("isAuthenticated");if(console.log("isAuthenticated+"+$cookies.get("isAuthenticated")),1==isAuthenticated)console.log("authenticatred is 1"),$cookies.put("isAuthenticated",2),$location.path("/dashboard1");else if(0==isAuthenticated)$location.path("/login");else if(2==isAuthenticated){console.log("isAuth is 2");var menu_scope=""+$rootScope.sections;if("undefined"==menu_scope){var success_login=function(data){$timeout(function(){$rootScope.$broadcast("menuSideBar",data),CommonService.SetData("menuSideBar",data),console.log("smentara diredirect ke dashboard 1 dulu")},1)},error_login=function(data){console.log("request menu failed")},user_info=$cookies.get("username");$log.info("user_info: "+user_info),console.log("username"),void 0!=user_info&&""!=user_info?SecurityModuleFactory.getMenu(user_info).then(success_login,error_login):$location.path("/login")}}}$rootScope.mainSearchActive=!1,$rootScope.sidebar_secondary=!1,$rootScope.secondarySidebarHiddenLarge=!1,$($window).width()<1220&&($rootScope.primarySidebarActive=!1,$rootScope.hide_content_sidebar=!1),toParams.hasOwnProperty("hidePreloader")||($rootScope.pageLoading=!0,$rootScope.pageLoaded=!1)}),FastClick.attach(document.body),$http.get("./package.json").success(function(response){$rootScope.appVer=response.version}),$rootScope.Modernizr=Modernizr;var w=angular.element($window);$rootScope.largeScreen=w.width()>=1220,w.on("resize",function(){return $rootScope.largeScreen=w.width()>=1220}),$rootScope.primarySidebarOpen=!!$rootScope.largeScreen,$rootScope.pageLoading=!0,$window.Waves.init()}]).run(["PrintToConsole",function(PrintToConsole){PrintToConsole.active=!1}]);
>>>>>>> Stashed changes
